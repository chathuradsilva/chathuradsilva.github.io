<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Unraveling Gravitational waves with LIGO data - Hello, world! I'm Keshan Sodimana</title>

  <!-- Edit site and author settings in `_config.yml` to make the social details your own -->

    <meta content="Hello, world! I'm Keshan Sodimana" property="og:site_name">
  
    <meta content="Unraveling Gravitational waves with LIGO data" property="og:title">
  
  
    <meta content="article" property="og:type">
  
  
    <meta content="Gravitational waves analysis with Python" property="og:description">
  
  
    <meta content="http://localhost:4000/Unraveling-Gravitational-waves/" property="og:url">
  
  
    <meta content="2017-11-25T00:00:00+05:30" property="article:published_time">
    <meta content="http://localhost:4000/about/" property="article:author">
  
  
    <meta content="http://localhost:4000/assets/img/gravity.gif" property="og:image">
  
  
    
  
  
    
    <meta content="Data analysis" property="article:tag">
    
    <meta content="physics" property="article:tag">
    
    <meta content="astrophysics" property="article:tag">
    
  

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@crazykesh">
  
    <meta name="twitter:title" content="Unraveling Gravitational waves with LIGO data">
  
  
    <meta name="twitter:url" content="http://localhost:4000/Unraveling-Gravitational-waves/">
  
  
    <meta name="twitter:description" content="Gravitational waves analysis with Python">
  
  
    <meta name="twitter:image:src" content="http://localhost:4000/assets/img/gravity.gif">
  

	<meta name="description" content="Gravitational waves analysis with Python">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="og:image" content="">
	<link rel="shortcut icon" href="/assets/img/favicon/favicon.ico" type="image/x-icon">
	<link rel="apple-touch-icon" href="/assets/img/favicon/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicon/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicon/apple-touch-icon-114x114.png">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#263959">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#263959">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#263959">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="/assets/fonts/font-awesome/css/font-awesome.min.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>

  <div class="wrapper">
    <aside class="sidebar">
  <header>
    <div class="about">
      <div class="cover-author-image">
        <a href="/"><img src="/assets/img/keshan.jpg" alt="Keshan Sanjaya Sodimana"></a>
      </div>
      <div class="author-name">Keshan Sanjaya Sodimana</div>
      <p>I am a Machine Learning enthusiast with a Computer Science background. Enjoy travelling, reading and learning cool new stuff.</p>
    <div><ul>
      <li><a href="/"><i>Home</i></a></li>
      <li><a href="/about/"><i>About</i></a></li>
      <li><a href="/publications/"><i>Publications & Presentations</i></a></li>
    </ul></div>
    </div>
  </header> <!-- End Header -->
  <footer>
    <section class="contact">
      <h3 class="contact-title">Contact me</h3>
      <ul>
        
          <li><a href="https://twitter.com/crazykesh" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
        
        
          <li><a href="https://facebook.com/keshan88" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
        
        
          <li class="github"><a href="http://github.com/keshan" target="_blank"><i class="fa fa-github"></i></a></li>
        
        
          <li class="linkedin"><a href="https://in.linkedin.com/in/keshan" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        
        
          <li class="email"><a href="mailto:keshan88@gmail.com"><i class="fa fa-envelope-o"></i></a></li>
        
      </ul>
    </section> <!-- End Section Contact -->
    <div class="copyright">
      <p>2018 &copy; Keshan Sanjaya Sodimana</p>
    </div>
  </footer> <!-- End Footer -->
</aside> <!-- End Sidebar -->
<div class="content-box clearfix">
  <article class="article-page">
  <div class="page-content">
    
    <div class="page-cover-image">
      <figure>
        <img class="page-image" src=/assets/img/gravity.gif alt="Unraveling Gravitational waves with LIGO data">
        
      </figure>
    </div> <!-- End Page Cover Image -->
    
    <div class="wrap-content">
      <header class="header-page">
        <h1 class="page-title">Unraveling Gravitational waves with LIGO data</h1>
        <div class="page-date"><span>2017, Nov 25&nbsp;&nbsp;&nbsp;&nbsp;</span></div>
      </header>
      <p>In 1916 the great mind of Albert Einstein predicted a phenomenon called Gravitational waves based on his masterpiece, The General theory of Relativity. Yet the technology wasn’t complex enough to prove any evidence of gravitational waves until 2016. Thanks to Nobel prize winning trio and their teams at <strong>LIGO</strong>, The Laser Interferometer Gravitational-Wave Observatory humans finally discovered the first evidence of gravitational waves.</p>

<p><strong><em>What is gravitational wave?</em></strong></p>

<p>Imagine you are standing on a rubber sheet, your weight will cause that rubber sheet to bend. Similarly, according to the theory of relativity the masses of objects create a distortion in the space around it. When there’s another object try to move in a straight line it will however going around that in an orbit because of that. It’s not actually a force pulling that object but the bending of the space. So, how does gravitational waves produce?.</p>

<p>It’s when these masses accelerate changing the distortion of the space will create these ripples of space and time. Theoretically everything with mass and energy can produce gravitational waves. for example two dancers doing a couple dance can produce gravitational waves <strong>BUT</strong> they are practically undetectable because gravity is an extremely weak force compared to other forces in the universe therefore it needs extremely massive very very fast moving objects to produce ripples which can be detectable, like the final moments of two black holes merging together.</p>

<p><strong><em>How on earth are we going to find them?</em></strong></p>

<p>If the space between us and the object stretch or compressed even the “marks” that have in the fabric of space will get stretched or compressed too. However, there’s one solution, light, if the space get stretched lights needs more time to reach and if the space get compressed light needs less time to travel the distance since it’s a constant and that’s basis of LIGO.</p>

<p>They have opened many of their datasets including the GW150914, first ever GW observed by human kind, on LIGO Open Science Centre.</p>

<p>The data plays a vital role in finding GWs because the effect of these ripples are so minuscule which can be confused with random noise so, scientists need a novel data analysis methods to unravel this mystery. It’s like trying to match a particular humming sound in a very very noisy room.</p>

<p>Let’s have a look at the GW150914.</p>

<p>LIGO has open the data in 3 formats. hd5, gwf and gzipped ascii text. gwf is a common data frame format for interferometric gravitational wave detectors and we will use this format for further analysis because there’s a great python library which supports this format called Pycbc (this post is just a quick look at the data and it’s results. I will write another post on Pycbc and the way to generate this results in depth later) This event was detected in data from two observatories, LIGO Hanford and LIGO Livingston.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Download the data.
curl -O -J https://losc.ligo.org/s/events/GW150914/H-H1_LOSC_4_V2-1126259446-32.gwf
curl -O -J https://losc.ligo.org/s/events/GW150914/L-L1_LOSC_4_V2-1126259446-32.gwf
</code></pre></div></div>

<p>Next see the the data in a time series.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pycbc.frame</span> <span class="kn">import</span> <span class="n">read_frame</span>
<span class="kn">from</span> <span class="nn">pycbc.filter</span> <span class="kn">import</span> <span class="n">highpass_fir</span><span class="p">,</span> <span class="n">lowpass_fir</span>
<span class="kn">from</span> <span class="nn">pycbc.psd</span> <span class="kn">import</span> <span class="n">welch</span><span class="p">,</span> <span class="n">interpolate</span>
<span class="kn">import</span> <span class="nn">pylab</span>
<span class="k">for</span> <span class="n">ifo</span> <span class="ow">in</span> <span class="p">[</span><span class="s">'H1'</span><span class="p">,</span> <span class="s">'L1'</span><span class="p">]:</span>
    <span class="c"># Read data: The data is available to the public through losc.ligo.org!</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="s">'</span><span class="si">%</span><span class="s">s-</span><span class="si">%</span><span class="s">s_LOSC_4_V2-1126259446-32.gwf'</span> <span class="o">%</span> <span class="p">(</span><span class="n">ifo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ifo</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">read_frame</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s">'</span><span class="si">%</span><span class="s">s:LOSC-STRAIN'</span> <span class="o">%</span> <span class="n">ifo</span><span class="p">)</span>
    
    <span class="c"># Estimate the noise spectrum and use it to whiten the data</span>
    <span class="n">psd</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">welch</span><span class="p">(</span><span class="n">ts</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">ts</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">white_strain</span> <span class="o">=</span> <span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">to_frequencyseries</span><span class="p">()</span> <span class="o">/</span> <span class="n">psd</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="c"># remove frequencies below and above where the main portion of the signal lies</span>
    <span class="n">smooth</span> <span class="o">=</span> <span class="n">highpass_fir</span><span class="p">(</span><span class="n">white_strain</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">smooth</span> <span class="o">=</span> <span class="n">lowpass_fir</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="c"># time shift and flip L1 to match the time of arrival and phase of Hanford</span>
    <span class="k">if</span> <span class="n">ifo</span> <span class="o">==</span> <span class="s">'L1'</span><span class="p">:</span>
        <span class="n">smooth</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">smooth</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="o">.</span><span class="mo">007</span> <span class="o">/</span> <span class="n">smooth</span><span class="o">.</span><span class="n">delta_t</span><span class="p">))</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">smooth</span><span class="o">.</span><span class="n">sample_times</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">smooth</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="n">ifo</span><span class="p">)</span>
<span class="c"># Plot the region around the signal (time is in gps seconds)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1126259462.26</span><span class="p">,</span> <span class="mf">1126259462.48</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Smoothed-Whitened Strain'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'GPS Time (s)'</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="https://cdn-images-1.medium.com/max/1600/1*m2neAecF43dXAvnDQKtWEQ.png" alt="There’s a clear visible spike in both Hanford and Livingston data." /></p>

<p>And here comes the most interesting part, converting the the merger of a black hole of 33 solar mass with a similar size neutrino star billions of light years away in other words happened billions of years ago.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pycbc.frame</span> <span class="kn">import</span> <span class="n">read_frame</span>
<span class="kn">from</span> <span class="nn">pycbc.filter</span> <span class="kn">import</span> <span class="n">highpass_fir</span><span class="p">,</span> <span class="n">lowpass_fir</span>
<span class="kn">from</span> <span class="nn">pycbc.psd</span> <span class="kn">import</span> <span class="n">welch</span><span class="p">,</span> <span class="n">interpolate</span>
<span class="kn">from</span> <span class="nn">pycbc.types</span> <span class="kn">import</span> <span class="n">TimeSeries</span>
<span class="c"># Read data and remove low frequency content</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s">'H-H1_LOSC_4_V2-1126259446-32.gwf'</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">highpass_fir</span><span class="p">(</span><span class="n">read_frame</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s">'H1:LOSC-STRAIN'</span><span class="p">),</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="c"># estimate the noise spectrum and whiten</span>
<span class="n">psd</span> <span class="o">=</span> <span class="n">interpolate</span><span class="p">(</span><span class="n">welch</span><span class="p">(</span><span class="n">h1</span><span class="p">),</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">white_strain</span> <span class="o">=</span> <span class="p">(</span><span class="n">h1</span><span class="o">.</span><span class="n">to_frequencyseries</span><span class="p">()</span> <span class="o">/</span> <span class="n">psd</span> <span class="o">**</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">psd</span><span class="o">.</span><span class="n">delta_f</span><span class="p">)</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="c"># remove some of the high and low frequencies</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">highpass_fir</span><span class="p">(</span><span class="n">white_strain</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">lowpass_fir</span><span class="p">(</span><span class="n">white_strain</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="c"># slow the data down by a factor of 4</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">smooth</span><span class="p">,</span> <span class="n">delta_t</span><span class="o">=</span><span class="n">smooth</span><span class="o">.</span><span class="n">delta_t</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="c">#strech out and shift the frequency upwards by 300 Hz to aid human hearing</span>
<span class="n">frequency_shift</span> <span class="o">=</span> <span class="mf">300.0</span>
<span class="n">fdata</span> <span class="o">=</span> <span class="n">smooth</span><span class="o">.</span><span class="n">to_frequencyseries</span><span class="p">()</span>
<span class="n">fdata</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">frequency_shift</span> <span class="o">/</span> <span class="n">fdata</span><span class="o">.</span><span class="n">delta_f</span><span class="p">))</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">fdata</span><span class="o">.</span><span class="n">to_timeseries</span><span class="p">()</span>
<span class="c">#Take slice around signal</span>
<span class="n">smooth</span> <span class="o">=</span> <span class="n">smooth</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">smooth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1500</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">smooth</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3000</span><span class="p">]</span>
<span class="n">smooth</span><span class="o">.</span><span class="n">save_to_wav</span><span class="p">(</span><span class="s">'gw150914_h1_chirp.wav'</span><span class="p">)</span>
</code></pre></div></div>

<p><a href="https://soundcloud.com/keshan-sodimana/gw150914-h1-chirp">You can listen to it from here</a></p>

<p>However, Gravitational waves are not sound. They travel at the speed of light, not speed of sound. Similar to how redios convert radio waves to it’s sound final chirp of the merger can be reconstructed with gravitational waves.</p>

<p><a href="https://soundcloud.com/keshan-sodimana/gw150914-template-whiten">You can listen to it from here</a></p>

<p>This finding has begun a new chapter in physics with a new branch of study the novel data analytics techniques with tons of data in the future with new observatories will soon produce some more amazing and surprising results.</p>

      <div class="page-footer">
        <div class="page-share">
          <a href="https://twitter.com/intent/tweet?text=Unraveling Gravitational waves with LIGO data&url=http://localhost:4000/Unraveling-Gravitational-waves/" title="Share on Twitter" rel="nofollow" target="_blank">Twitter</a>
          <a href="https://facebook.com/sharer.php?u=http://localhost:4000/Unraveling-Gravitational-waves/" title="Share on Facebook" rel="nofollow" target="_blank">Facebook</a>
          <a href="https://plus.google.com/share?url=http://localhost:4000/Unraveling-Gravitational-waves/" title="Share on Google+" rel="nofollow" target="_blank">Google+</a>
        </div>
        <div class="page-tag">
          
            <a href="/tags#Data analysis" class="tag">&#35; Data analysis</a>
          
            <a href="/tags#physics" class="tag">&#35; physics</a>
          
            <a href="/tags#astrophysics" class="tag">&#35; astrophysics</a>
          
        </div>
      </div>
      <section class="comment-area">
  <div class="comment-wrapper">
    
    <div id="disqus_thread" class="article-comments"></div>
    <script>
      (function() {
          var d = document, s = d.createElement('script');
          s.src = '//keshan.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
  </div>
</section> <!-- End Comment Area -->

    </div> <!-- End Wrap Content -->
  </div> <!-- End Page Content -->
</article> <!-- End Article Page -->

</div>

  </div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-122765133-1', 'auto');
  ga('send', 'pageview');
</script> <!-- End Analytics -->

</body>
</html>
